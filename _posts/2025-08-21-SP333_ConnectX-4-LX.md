---
layout: post
title:  "Aliexpressで安価に買えるSP333なるConnectX-4 LXの考察"
date:   2025-08-21 17:53:26 +0900
categories: server hardware
---



# Aliexpressで安価に買えるSP333なるConnectX-4 LXの考察



## SP333？

AliexpressにMCX4121AのHuaweiOEM版として3000円台の安価で出回っているSP333(25/8/21 3350円)

2ポートのConnectX-4 LXとしてはかなり安価なため、メインPC用に買ってみた。
記事を書くのを思い立ったのがPC組み込み後なので写真はありません。



## SP333ではない？STL2IEA2AとSP380

実際に届いたものは抜き取り品のようだが状態はかなり良い。DC内で使われていたのだろう。
ファームウェアを確認すると製品名は以下の通り。

> Huawei_STL2IEA2A_CX4LX_2P_25G_Ax

ここでおや？となる。

そもそもSP333はhuaweiの公式マニュアルによれば10Gポート2つとの扱いになっている。(XCAT相当)
そしてSP380という25Gポート2つの扱いになっているモデルも存在している。（ACAT相当）

両者ともSTL2IEA2Aとプリントされた基板を利用しており、SP333はファームウェア的に性能が抑えられているだけでハード的には同じ製品となるようだ。

つまりこの製品はSP333として売られているが、実際にはSP380に***近い仕様***のものとなる。
”***近い仕様***”というのは、ハードウェアこそ共通のようで基板名をそのまま製品名として名乗っているが搭載ファームウェアはSP333のものでもSP380のものでもないからだ。
ConnectXは製品ごとにファームウェアにPSIDというIDが割り振られており、この製品はSP333のものともSP380のものとも異なるPSIDが割り振られている。また、SP380の場合本来製品名は下記のようにならなければならない。

> Huawei_SP380_ConnectX4Lx_2P_25GbE_Ax

おそらく単体のオプションパーツとしても提供されているSP333/SP380とは違い、特定のサーバー用の標準のNICとして組み込まれていたものなのだろう。



## ファームウェア更新

10G仕様ではなく25G仕様のものが来たのは僥倖だが、そのままではファームウェアが14.17.1010という非常に古いものであるためファームウェアを更新したい。

### SP380のファームウェア入手

ただこの製品のファームウェアはどこにも配布されておらず、mlxup等での更新は失敗するため、SP380のファームウェアを無理やり焼く方法を探したところ、中国のブログでSP333にSP380のファームウェアを入れている例を発見。

> https://tinychen.com/20241211-huawei-sp333-firmware-burn/#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C

SP333/380のファームウェアはHuaweiの公式から入手しようとするとアカウントが必要であり、さらに対応する製品の製品登録もしなくてはDLできない仕組みのようだが、このサイトでは日本でも事業を展開している中国系サーバーベンダーのサポートサイトからファームウェアを入手することに成功したようだ。残念ながら提示されていたURLは使えなくなっていたが、同じように国内で事業を展開している中国系のサーバーベンダーのサイトをあれこれ探したところ、ファームウェアをDLすることができた。（なんか言われたりするのも嫌なので詳細は伏せてふわっとした言い方にしています。お察しください。）

### ファームウェア焼きこみ

MFTとか一通り入っている前提。
--nofsを付けないと自分はダメだった。このオプションはフェイルセーフを無効にするため危険。なしで実行できるならそれに越したことはありません。
**文鎮になっても泣かない。自己責任でお願いします。**

`flint --nofs --no_fw_ctrl -allow_psid_change -d mt4117_pciconf0 -i 入手したファームウェア burn`

一旦任意のSP380のファーム入れるの成功すると以後のアップデートはmlxfwmanagerでできるようになるっぽい。



### 結果

全てが終わったあとの結果

```
Device Type:      ConnectX4LX
Part Number:      Huawei_SP380_ConnectX4Lx_2P_25GbE_Ax
Description:      Huawei SP380 2-port 25G Ethernet Adapter PCIE Gen3 x8
PSID:             HUA0000000023
PCI Device Name:  mt4117_pciconf0
Base MAC:         N/A
Versions:         Current        Available
  FW             14.32.1010     N/A
  PXE            3.6.0502       N/A
  UEFI           14.25.0017     N/A

Status:           No matching image found
```



## 付属PCIブラケットについて

デフォルトのロープロファイルのブラケットとオプションの通常サイズのブラケットはネジのサイズが違う。

ロープロファイルはM3っぽいが通常サイズのブラケットはM2.5っぽい。

ネジは付属しないので用意しておくこと。



# ぶっちゃけた話

Aliexpressの同じ店で3350円で買えるMCX4421A-ACQN(OCP用の基板だが、PCIE変換基板とPCIブラケットまでセットにしてくれている)を買った方が楽そう。レビュー見る限りファームの更新も癖なさそうだし。

